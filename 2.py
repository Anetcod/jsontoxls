import xlwt


def main(data: dict):
    if not data:
        return None

    wb = xlwt.Workbook()
    ws = wb.add_sheet('main')
    worker_count = 0
    worker_values = list(data['workers'].values())

    for date in worker_values[0]['dates']:
        ws.write(
            0, 1 + list(worker_values[0]['dates'].keys()).index(date), date)

    for worker in worker_values:
        _ = 0 if worker_count == 0 else 1
        worker_dates = list(worker['dates'].keys())

        ws.write(1 + (worker_count * 2 + 2 * _), 0, worker['name'])
        ws.write(2 + (worker_count * 2 + 2 * _), 0, 'Удары')
        ws.write(3 + (worker_count * 2 + 2 * _), 0, 'Опоздания')

        for date in (worker['dates'].items()):
            ws.write(2 + (worker_count * 2 + 2 * _), 1 +
                     worker_dates.index(date[0]), date[1]['0'])
            ws.write(3 + (worker_count * 2 + 2 * _), 1 +
                     worker_dates.index(date[0]), date[1]['1'])

        worker_count += 1

    wb.save('example.xls')

    return True


if __name__ == '__main__':
    data = {"workers": {"1": {"dates": {"24.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "25.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "26.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "27.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "28.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "29.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "30.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}}, "name": "\u0425\u043e\u043b\u043e\u043f \u0425\u043e\u043b\u043e\u043f\u043e\u0432"}, "2": {
        "dates": {"24.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "25.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "26.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "27.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "28.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "29.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}, "30.06.2019": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "v": 0}}, "name": "\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442"}}}

    main(data)
